%
% Einführung in die Mustererkennung - WS2013
% Abgabeprotokoll Exercise 1
%
%

%{{{ misc
\documentclass[a4paper,psfig,subfigure,epsfig,fleqn,amssmb,float,caption,fontenc,ausarbeitung]{article}

\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{pgfplots}

%Zitieren:
\usepackage[english]{babel}
%\usepackage[german]{babel}
\usepackage{babelbib} % für das Erstellen des Bibtex-Literaturverzeichnisses
\usepackage{cite}
%\selectbiblanguage{english}
%\selectbiblanguage{german}


\usepackage{url}

\usepackage[]{mcode}

\usepackage[pdftitle={Einfuehrung in die Mustererkennung, Exercise 1},
            pdfauthor={David Pfahler},
						pdfauthor={Matthias Gusenbauer},
						pdfauthor={Matthias Vigele},
            pdfsubject={Mustererkennung},
            pdfborder={0 0 0}]{hyperref}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Titlepage

\pagestyle{empty}


%set dimensions of columns, gap between columns, and paragraph indent

\setlength{\textheight}{24.7 cm}
\setlength{\columnsep}{1 cm}
\setlength{\textwidth}{16 cm}
%\setlength{\footheight}{0.0 cm}
\setlength{\topmargin}{0.0 cm}
\setlength{\headheight}{0.0 cm}
\setlength{\headsep}{-0.3 cm}
\setlength{\oddsidemargin}{0.0 cm}
\setlength{\parindent}{0.7 cm}
\setlength{\mathindent}{0mm}

% set page counter if document is part of proceedings
\setcounter{page}{1}
\renewcommand{\floatpagefraction}{0.9}
\renewcommand{\textfraction}{0.1}

%\renewcommand{\captionlabelfont}{\fontfamily{phv}\fontseries{bx}\fontsize{10}{10pt}\selectfont}
%\renewcommand{\captionfont}{\fontfamily{phv}\fontsize{10}{12pt}\selectfont}
%\setlength{\captionmargin}{0.5 cm}

\makeatletter
\makeatother
\def\RR{\hbox{I\kern-.2em\hbox{R}}}


\begin{document}

%don't want date printed
\date{}

%make title bold and 14 pt font (Latex default is non-bold, 16pt) 
\title{~\\
  ~\\
  \fontsize{14}{14pt} \bf Abgabedokument Exercise 1
	 ~\\
  \fontsize{12}{12pt} \bf Einführung in die Mustererkennung 186.840 WS 2013}

%for single author 
\author{~\\
  ~\\
  \fontsize{12}{12pt}
  {\bf David Pfahler, Matthias Gusenbauer, Matthias Vigele}\\
  1126287, 1125577, 1126171
  ~\\ ~\\ ~\\
  \normalsize
  {\bf ABSTRACT} \\ 
  \noindent
  \hspace{0.2cm}
  \begin{minipage}[c]{15cm}
  \normalsize This is my abstract.  This is my abstract.  This is my
    abstract.  This is my abstract.  This is my abstract.  This is my
    abstract.  This is my abstract.  This is my abstract.  This is my
    abstract.  This is my abstract.  This is my abstract.  This is my
    abstract.\\
  \end{minipage}
  ~\\ ~\\ ~\\
  \normalsize
  {\bf KEYWORDS} \\ 
  \normalsize
  Keyword1, Keyword2, Keyword3, Keyword4, Keyword5, Keyword6.
  }

\maketitle
%I don't know why I have to reset thispagestyle, but otherwise get page numbers 
\normalfont
\thispagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CONTENT

\section{Feature Extraction}
\label{sec:featureExtraction}

This section describes the used image classes and the features that are used for the classification (see Section \ref{sec:classification}. 

\subsection{Input Images}
\label{sec:input}

5 Classes from the MPEG7 CE-Shape-1 database \cite{latecki2000shape} are used. We used:

\begin{itemize}
	\item Heart
	\item device4
	\item bat
	\item device1
	\item Bone
\end{itemize}

Figure \ref{fig:classes} shows example images of the used classes.

\begin{figure}
	\centering
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{img/Heart-1}
		\caption{Heart}
	\end{subfigure}
	~ 
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{img/Bone}
		\caption{Bone}
	\end{subfigure}
	~
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{img/device1}
		\caption{device1}
	\end{subfigure}
	~
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{img/device4}
		\caption{device4}
	\end{subfigure}
	~
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{img/bat}
		\caption{bat}
	\end{subfigure}
	~
	\caption{5 used Classes from the MPEG7 CE-Shape-1 database \cite{latecki2000shape}}
	\label{fig:classes}
\end{figure}


\subsection{Features}
\label{sec:features}

In the following section the used features are described. To evaluate scale, 
transformation and rotation invariants a test image is used. Listing 
\ref{lst:calcRot} shows the used matlab function. Figure \ref{fig:heart} 
shows the test image. 

\begin{lstlisting}[caption=Calculate rotated image, label=lst:calcRot]
	rot = imresize(imrotate(image,45),0.5);
\end{lstlisting}
The calculation of the features of the two test images will differ, because 
of the lost of accuracy by the size reduction.

\subsubsection{Eccentricity}
\label{sec:eccentricity}

The Eccentricity is a scalar value that measures of how much the object 
deviates from a circle. It is calculated by the ratio of the distance between 
the foci of the ellipse and its major axis length. See Equation 
\ref{eq:eccentricity}
\begin{equation}
	\frac{2*\sqrt{\frac{D_{max}}{2}^2-\frac{D_{min}}{2}^2}}{D_{max}}
	\label{eq:eccentricity}
\end{equation}
$D_{max}$ is the major axis length and $D_{min}$ is the minor axis length of 
the best-fit ellipse.

\paragraph{Invariance:} The eccentricity feature is scale, transformation and 
rotation invariant. The Listing \ref{lst:eccentricity} provides an example. 
Figure \ref{fig:heart} shows the used binary images.

\begin{lstlisting}[caption=Calculate eccentricity in matlab, label=lst:eccentricity]
>> regionprops(image,'Eccentricity')

ans = 

    Eccentricity: 0.7073

>> regionprops(rot,'Eccentricity')

ans = 

    Eccentricity: 0.7080
\end{lstlisting}

\subsubsection{Roundness}
\label{sec:roundness}

Roundness is a scalar value that describe how the shape of an object 
approaches that of a circle. A value of 1 means that the object is a circle 
and a value of 0 means the object is a line segment. See Equation \ref{eq:roundness}
\begin{equation}
  \frac{4A(R)}{\pi D^{2}_{max}}
	\label{eq:roundness}
\end{equation}
$A(R)$ is the area of the labeled binary image and $D_{max}$ is the major axis 
length of the best-fit ellipse.

\paragraph{Invariance:} The Roundness feature is scale, transformation and 
rotation invariant. The Listing \ref{lst:roundness} provides an example. 
Figure \ref{fig:heart} shows the used binary images.

\begin{lstlisting}[caption=Calculate roundness in matlab, label=lst:roundness]
	>> calculateRoundness(image)

	ans = 

			Roundness: 0.6333
	
	>> calculateRoundness(rot)

	ans = 

			Roundness: 0.6326
\end{lstlisting}

\begin{figure}
	\centering
	\begin{subfigure}[b]{0.4\textwidth}
		\includegraphics[width=\textwidth]{img/heart.jpg}
	\end{subfigure}
	~ 
	\begin{subfigure}[b]{0.4\textwidth}
		\includegraphics[width=\textwidth]{img/invariance_rotation.jpg}
	\end{subfigure}
	\caption{A rotated, translated and scaled image}
	\label{fig:heart}
\end{figure}


\subsubsection{Solidity}
\label{sec:solidity}

The solidity is a scalar value specifying the proportion of the pixels in the 
convex hull that are also in the region. See Equation \ref{eq:solidity}

\begin{equation}
\frac{A(R)}{A(Co(R))}
\label{eq:solidity}
\end{equation}
$A(R)$ is the area of the labeled binary image and $Co(R)$ is the convex hull of the binary image

\paragraph{Invariance:} The solidity feature is scale, transformation and 
rotation invariant. The Listing \ref{lst:solidity} provides an example. 
Figure \ref{fig:heart} shows the used binary images.
\begin{lstlisting}[caption=Calculate solidity in matlab, label=lst:solidity]
>> regionprops(image,'Solidity')

ans = 

    Solidity: 0.9145

>> regionprops(rot,'Solidity')

ans = 

    Solidity: 0.9113
\end{lstlisting}

\subsection{Results}
\label{sec:fResults}

With the {\tt matlab} function {\tt getFeatures} all features for all input 
images (see Section \ref{sec:input}) are calculated. In Figure \ref{fig:boxplot} 
a boxplot  of this features is shown. The boxplot is a convenient way of 
graphically depicting groups of numerical data through their quartiles. 
\cite{tukey1977exploratory}
The Figure \ref{fig:gscatter} shows the dependencies of all features and displays outliers.

\begin{figure}
	\centering
	\newlength\figureheight 
	\newlength\figurewidth 
	\setlength\figureheight{6cm} 
	\setlength\figurewidth{10cm}
	\input{img/boxplot.tex}
	\caption{Boxplot of all features}
	\label{fig:boxplot}
\end{figure}

\begin{figure}
	\centering
	\setlength\figureheight{4cm} 
	\setlength\figurewidth{10cm}
	\input{img/gscatter.tikz}
	\caption{Scatterplot of all features in relation}
	\label{fig:gscatter}
\end{figure}







\section{Classification}
\label{sec:classification}
This section describes the two classification algorithms, one is hand-tuned (see Section \ref{sec:own}) and the other k-NN-based (see Section \ref{sec:kNN}), that are used to classify the images. Both of these algorithms use the feature values described in Section \ref{sec:features} to distinguish between the five classes mentioned in Section \ref{sec:input}.

\subsection{Own Implementation}
\label{sec:own}
Our classification algorithm uses thresholds on the feature values to determine the class of an image.

\subsubsection{Methods}
\label{sec:ownMethods}
The {\tt matlab} function {\tt customClassifier} takes all the computed feature values (see Section \ref{sec:fResults}) as input to classify the images.
Various thresholds are used to distinguish between the five classes. For example (see Listing \ref{lst:solidity}): An image with an eccentricity value greater than or equal to 0.8 could be a member of either the "bat" or the "heart" class. But it is possible to distinguish the two classes by taking another feature value into account: The image has to be a member of the  "heart" class, if its roundness value is also greater than or equal to 0.4.

\begin{lstlisting}[caption=Example for two thresholds, label=lst:thresholdEx]
       if(featureV(1)>=0.8)
           %bat or heart
           classNames{i}='bat';         
           %roundness threshold
           if(featureV(2)>=0.4)
           %heart
           classNames{i}='Heart';                     
           end
       end
\end{lstlisting}

\subsubsection{Results}
\label{sec:ownResults}
Our classifier classifies 100\% of the objects correctly.

\subsection{k-NN Classifier}
\label{sec:kNN}
The k-NN Classifier uses a set of pre-classified feature vectors to classify another set of feature vectors.

\subsubsection{Methods}
\label{sec:kNNMethods}
The {\tt matlab} function {\tt k\_NN} classifies an feature vector by computing its k nearest neighbours (using the Euclidean distance) in the training set, and labeling the image with the class name that is most common among these neighbours.

\subsubsection{Results}
\label{sec:kNNResults}
As shown in Figure \ref{fig:results}, the number of correctly classified images drops significally with increasing k.
\begin{figure}
	\centering
	\setlength\figureheight{7cm} 
	\setlength\figurewidth{9cm}
	\input{img/results.tikz}
	\caption{\% of correct classifications with varying k}
	\label{fig:results}
\end{figure}

\section{Paper Summary}
\label{sec:paperSummary}
\cite{beyer1999nearest}

% Biblography


\fontsize{9}{10pt}
\bibliographystyle{plain}
\bibliography{literatur}

\end{document}

% vim:foldmethod=marker
